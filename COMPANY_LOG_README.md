# Функциональность логов компаний

## Описание

Добавлена функциональность для отображения последнего лога событий в блоке "Лог событий" на странице просмотра компании.

## Что было реализовано

### 1. Обновлен контроллер `CompanyController`
- В методе `show()` добавлена загрузка последнего лога компании
- Лог загружается с отношениями `type` и `user`

### 2. Обновлены модели
- `CompanyLog` - добавлены отношения к `LogType`, `User` и `Company`
- `LogType` - добавлено отношение к логам

### 3. Обновлено представление `CompanyShowPage.blade.php`
- Заменен статический контент на динамический вывод последнего лога
- Добавлена обработка случаев:
  - Когда лог отсутствует
  - Когда тип лога не найден
  - Когда пользователь не найден
  - Когда `user_id = NULL` (показывается "Система")

### 4. Форматирование данных
- Дата выводится в формате: `18.08.2025 08:42:36`
- Цвет типа лога определяется по полю `color` из таблицы `log_types`
- Имя пользователя получается по `user_id`

## Структура данных

### Таблица `company_logs`
- `id` - уникальный идентификатор
- `company_id` - ID компании
- `user_id` - ID пользователя (может быть NULL)
- `type_id` - ID типа лога
- `log` - текст лога
- `created_at` - дата создания
- `updated_at` - дата обновления

### Таблица `log_types`
- `id` - уникальный идентификатор
- `name` - название типа (например, "Комментарий", "Системный")
- `color` - цвет в формате HEX (например, "#133E71", "#6c757d")

## Команды для тестирования

### Просмотр логов компании
```bash
php artisan test:company-log {company_id}
```

### Создание тестового лога
```bash
php artisan create:test-log {company_id} --type=1 --user=null --message="Тестовый лог"
```

Параметры:
- `company_id` - ID компании (обязательный)
- `--type` - ID типа лога (по умолчанию 1)
- `--user` - ID пользователя (по умолчанию null)
- `--message` - текст лога (по умолчанию "Тестовый лог")

## Примеры использования

### Создание системного лога
```bash
php artisan create:test-log 1 --type=2 --user=null --message="Система обновила статус компании"
```

### Создание лога от пользователя
```bash
php artisan create:test-log 1 --type=1 --user=1 --message="Позвонил клиенту, уточнил детали"
```

## Отображение на странице

В блоке "Лог событий" отображается:
1. **Тип лога** - с соответствующим цветом
2. **Дата и время** - в формате `dd.mm.yyyy hh:mm:ss`
3. **Текст лога** - содержимое поля `log`
4. **Создатель** - имя пользователя или "Система" если `user_id = NULL`

Если логов нет, отображается сообщение "Логи событий отсутствуют".
